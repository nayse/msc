import androidx.test.espresso.Espresso;
import androidx.test.espresso.action.ViewActions;
import androidx.test.espresso.assertion.ViewAssertions;
import androidx.test.espresso.matcher.ViewMatchers;
import androidx.test.ext.junit.rules.ActivityScenarioRule;
import androidx.test.ext.junit.runners.AndroidJUnit4;

import org.junit.Rule;
import org.junit.Test;
import org.junit.runner.RunWith;

@RunWith(AndroidJUnit4.class)
public class NewTransactionScreenTest {

    @Rule
    public ActivityScenarioRule<YourMainActivity> activityScenarioRule =
            new ActivityScenarioRule<>(YourMainActivity.class); // Replace YourMainActivity with your actual Activity

    @Test
    public void testAddNewExpenseTransaction() {
        // Assume the dialog is already open, or add code to open it if needed
        // For example, if there's a button to open it:
        // Espresso.onView(ViewMatchers.withId(R.id.fab_add_transaction)).perform(ViewActions.click());

        // 1. Enter title for expense 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("editText_transaction_name")))
                .perform(ViewActions.typeText("Coffee"), ViewActions.closeSoftKeyboard()); [cite: 1]

        // 2. Ensure "Expense" radio button is selected (it's often default) 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("radioButton_transaction_expense")))
                .check(ViewAssertions.matches(ViewMatchers.isChecked())); [cite: 1]

        // 3. Enter amount for expense 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("dialog_transaction_amount")))
                .perform(ViewActions.typeText("5.50"), ViewActions.closeSoftKeyboard()); [cite: 1]

        // 4. Click SUBMIT button 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("button1")))
                .perform(ViewActions.click()); [cite: 2]

        // Expected Result: Dialog closes. You would typically add an assertion here to verify
        // the transaction appears in a list or a confirmation message.
        // For this example, we'll just check if the dialog is no longer displayed.
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("alertTitle")))
                .check(ViewAssertions.doesNotExist()); [cite: 1]
    }

    @Test
    public void testAddNewIncomeTransaction() {
        // Assume the dialog is already open
        // Espresso.onView(ViewMatchers.withId(R.id.fab_add_transaction)).perform(ViewActions.click());

        // 1. Enter title for income 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("editText_transaction_name")))
                .perform(ViewActions.typeText("Salary"), ViewActions.closeSoftKeyboard()); [cite: 1]

        // 2. Select "Income" radio button 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("radioButton_transaction_income")))
                .perform(ViewActions.click()); [cite: 1]

        // 3. Enter amount for income 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("dialog_transaction_amount")))
                .perform(ViewActions.typeText("2500.00"), ViewActions.closeSoftKeyboard()); [cite: 1]

        // 4. Click SUBMIT button 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("button1")))
                .perform(ViewActions.click()); [cite: 2]

        // Expected Result: Dialog closes.
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("alertTitle")))
                .check(ViewAssertions.doesNotExist()); [cite: 1]
    }

    @Test
    public void testCancelTransaction() {
        // Assume the dialog is already open
        // Espresso.onView(ViewMatchers.withId(R.id.fab_add_transaction)).perform(ViewActions.click());

        // 1. Enter some text in title (optional, just to show interaction before cancelling) 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("editText_transaction_name")))
                .perform(ViewActions.typeText("Unwanted Transaction"), ViewActions.closeSoftKeyboard()); [cite: 1]

        // 2. Click CANCEL button 
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("button2")))
                .perform(ViewActions.click()); [cite: 2]

        // Expected Result: Dialog closes.
        Espresso.onView(ViewMatchers.withTagValue(ViewMatchers.is("alertTitle")))
                .check(ViewAssertions.doesNotExist()); [cite: 1]
    }
}