import androidx.test.espresso.Espresso.onView
import androidx.test.espresso.action.ViewActions.*
import androidx.test.espresso.assertion.ViewAssertions.matches
import androidx.test.espresso.matcher.ViewMatchers.*
import androidx.test.ext.junit.rules.ActivityScenarioRule
import org.junit.Rule
import org.junit.Test
import your.package.name.R

class NewTransactionTest {

    @get:Rule
    val activityRule = ActivityScenarioRule(NewTransactionActivity::class.java)

    @Test
    fun addNewTransaction_successfully() {
        // Enter title
        onView(withId(R.id.transaction_title))
            .perform(typeText("Groceries"), closeSoftKeyboard())

        // Select "Expense" radio button
        onView(withId(R.id.radio_expense)).perform(click())

        // Enter amount
        onView(withId(R.id.transaction_amount))
            .perform(typeText("150"), closeSoftKeyboard())

        // Select account from dropdown
        onView(withId(R.id.account_dropdown)).perform(click())
        onData(allOf(`is`(instanceOf(String::class.java)), `is`("Main Account"))).perform(click())

        // Select category from dropdown
        onView(withId(R.id.category_dropdown)).perform(click())
        onData(allOf(`is`(instanceOf(String::class.java)), `is`("Food"))).perform(click())

        // Click SUBMIT button
        onView(withId(R.id.submit_button)).perform(click())

        // Assert: Check if success message or redirection occurs
        // Example: check if transaction list screen is displayed or toast is shown
        onView(withText("Transaction saved")).inRoot(ToastMatcher())
            .check(matches(isDisplayed()))
    }
}
