import static androidx.test.espresso.Espresso.onView;
import static androidx.test.espresso.action.ViewActions.click;
import static androidx.test.espresso.assertion.ViewAssertions.matches;
import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
import static androidx.test.espresso.matcher.ViewMatchers.withText;
import static androidx.test.espresso.matcher.ViewMatchers.withTagValue;
import static androidx.test.espresso.matcher.ViewMatchers.withClassName;
import static org.hamcrest.CoreMatchers.is;

import androidx.test.ext.junit.rules.ActivityScenarioRule;
import androidx.test.ext.junit.runners.AndroidJUnit4;

import org.junit.Rule;
import org.junit.Test;
import org.junit.runner.RunWith;

// Assuming the main Activity is named MainActivity
@RunWith(AndroidJUnit4.class)
public class FilterSelectionTest {

    @Rule
    public ActivityScenarioRule<MainActivity> activityRule = 
        new ActivityScenarioRule<>(MainActivity.class);

    /**
     * Test a selection in each major filter category to validate interactivity.
     * We check if the element exists and is clickable, then perform the click.
     * Note: Visual state change (e.g., selection highlight) is an advanced
     * check often requiring custom Matchers/Assertions. This test focuses on 
     * the fundamental 'clickability' of the core UI elements.
     */
    @Test
    public void testFilterSelections() {
        // 1. Validate clicking an Area Number on the map (Area 6)
        // Area 6 on the map uses a Text tag with text "6"
        onView(withText("6"))
            .check(matches(isDisplayed()))
            .perform(click());

        // 2. Validate clicking a Colored Region Button (Area 2)
        // Region 2 button has Text "2" nested inside a View
        onView(withText("2"))
            .check(matches(isDisplayed()))
            .perform(click());

        // 3. Validate clicking a Named Regional Center (Rovereto)
        // Rovereto button has Text "Rovereto"
        onView(withText("Rovereto"))
            .check(matches(isDisplayed()))
            .perform(click());
            
        // 4. Validate clicking a Transport Mode (Railway)
        // Railway button has Text "Railway"
        onView(withText("Railway"))
            .check(matches(isDisplayed()))
            .perform(click());

        // 5. Validate clicking the "All" button
        // "All" button for transport has Text "All"
        // Note: There is another 'All' button at the top header area.
        // We use the one with the transport context (lower down)
        onView(withText("All"))
            .check(matches(isDisplayed()))
            // Clicks the lower "All" button. If there are multiple, Espresso might fail or pick the first.
            // A more robust test would use: onView(allOf(withText("All"), isDescendantOfA(withId(R.id.transport_group)))).
            // For this basic test, we assume 'withText("All")' targets the transport filter.
            .perform(click()); 
    }
}